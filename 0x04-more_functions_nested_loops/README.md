more nested-loop functions on this project.
